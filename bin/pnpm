#!/usr/bin/env ruby
APP_ROOT = File.expand_path('..', __dir__)
Dir.chdir(APP_ROOT) do
  pnpm = ENV.fetch('PATH', '').split(File::PATH_SEPARATOR).
    reject { |dir| File.expand_path(dir) == __dir__ }.
    product(%w[pnpm pnpm.cmd pnpm.ps1]).
    map { |dir, file| File.expand_path(file, dir) }.
    find { |file| File.executable?(file) }

  if pnpm
    exec pnpm, *ARGV
  else
    $stderr.puts 'pnpm executable was not detected in the system.'
    $stderr.puts 'Install pnpm via https://pnpm.io/installation'
    exit 1
  end
end
